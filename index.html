<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>IPL 2026 Mega Auction - LIVE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="https://iplstatic.s3.amazonaws.com/ipl/logo.png">
<script src="https://cdn.jsdelivr.net/npm/confetti-js@0.0.18/dist/index.min.js"></script>
<style>
:root{--bg:#0a0e1a;--card:#1e293b;--text:#e2e8f0;--green:#10b981;--red:#ef4444;--gold:#fbbf24;--blue:#3b82f6;--orange:#ff6d00;--purple:#a855f7;--border:#334155;--yellow:#fbbf24;}
.light-mode{--bg:#f8fafc;--card:#ffffff;--text:#0f172a;--border:#e2e8f0;}
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,sans-serif;}
body{background:var(--bg);color:var(--text);min-height:100vh;transition:0.5s;}
.container{max-width:1400px;margin:0 auto;padding:15px;}

header{text-align:center;padding:40px;background:linear-gradient(135deg,#1e3a8a,#0f172a);border-bottom:8px solid var(--gold);}
h1{font-size:4.5rem;color:var(--gold);text-shadow:0 0 40px #000;}
.subtitle{color:#94a3b8;font-size:1.6rem;margin-top:10px;}

.top-bar{display:flex;justify-content:space-between;align-items:center;margin:35px 0;}
.status{padding:18px 45px;border-radius:50px;font-weight:bold;font-size:2rem;}
.status.live{background:#166534;color:white;animation:pulse 2s infinite;}
.status.stopped{background:#991b1b;color:white;}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.6}}
.timer{background:var(--card);padding:18px 45px;border-radius:50px;border:4px solid var(--border);font-size:2.5rem;font-weight:bold;}

.set-nav{display:flex;justify-content:center;gap:30px;align-items:center;margin:40px 0;}
.set-btn{padding:20px 50px;background:var(--purple);color:white;border:none;border-radius:50px;font-size:1.8rem;font-weight:bold;cursor:pointer;box-shadow:0 15px 40px rgba(168,85,247,0.4);}
.set-btn:hover{transform:scale(1.1);}
.set-info{font-size:2.8rem;color:var(--gold);font-weight:900;}

.grid{display:grid;grid-template-columns:1fr 480px;gap:40px;margin-top:40px;}
@media(max-width:968px){.grid{grid-template-columns:1fr;}}

.card{background:var(--card);border-radius:25px;padding:40px;border:2px solid var(--border);margin-bottom:35px;box-shadow:0 25px 70px rgba(0,0,0,0.7);}
.player-card{text-align:center;}
.player-photo{width:220px;height:220px;background:#334155;border-radius:50%;margin:0 auto 35px;display:flex;align-items:center;justify-content:center;font-size:100px;font-weight:bold;color:#64748b;border:10px solid var(--gold);}
.current-bid{background:var(--green);color:black;padding:50px;border-radius:30px;font-size:6.5rem;font-weight:900;margin:50px 0;box-shadow:0 25px 60px rgba(16,185,129,0.6);}
.bid-team{display:flex;align-items:center;justify-content:center;gap:40px;margin:40px 0;}
.team-logo{width:110px;height:110px;background:white;color:var(--bg);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;font-size:3rem;box-shadow:0 20px 50px rgba(0,0,0,0.7);}
.interested{display:flex;flex-wrap:wrap;gap:18px;justify-content:center;margin:50px 0;}
.tag{background:#334155;padding:18px 35px;border-radius:50px;font-weight:700;font-size:1.4rem;}

.team-table{width:100%;border-collapse:collapse;margin-top:25px;}
.team-table th,.team-table td{padding:18px;border:1px solid var(--border);text-align:center;font-size:1.2rem;}
.team-table th{background:#1e293b;}

.login-box{max-width:600px;margin:100px auto;background:var(--card);padding:60px;border-radius:30px;text-align:center;box-shadow:0 40px 120px rgba(0,0,0,0.9);}
input{width:100%;padding:22px;margin:25px 0;border-radius:20px;border:none;background:#334155;color:white;font-size:1.8rem;}
.btn{width:100%;padding:25px;border:none;border-radius:20px;font-weight:bold;font-size:1.8rem;cursor:pointer;margin-top:30px;transition:0.4s;}
.btn:hover{transform:scale(1.05);}
.btn-green{background:var(--green);color:black;}
.btn-red{background:var(--red);color:white;}
.btn-blue{background:var(--blue);color:white;}
.btn-orange{background:var(--orange);color:white;}
.btn-purple{background:var(--purple);color:white;}

.not-started{text-align:center;padding:120px;background:var(--red);color:white;border-radius:35px;font-size:4rem;font-weight:900;margin:80px 0;box-shadow:0 30px 80px rgba(239,68,68,0.7);}

.team-bid-panel{display:none;background:var(--card);padding:50px;border-radius:30px;text-align:center;border:6px solid var(--gold);margin:40px 0;}
.bid-buttons{display:grid;grid-template-columns:repeat(3,1fr);gap:25px;margin:40px 0;}
.bid-btn{padding:35px;font-size:2.5rem;font-weight:bold;border-radius:25px;cursor:pointer;background:var(--green);color:black;box-shadow:0 15px 40px rgba(16,185,129,0.5);}
.bid-btn:hover{transform:scale(1.15);}

.admin-panel{display:none;margin-top:60px;}
.admin-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:30px;margin-top:40px;}

.beta-banner{background:linear-gradient(135deg,#f59e0b,#d97706);color:#7c2d12;padding:30px;border-radius:25px;text-align:center;font-size:2.5rem;font-weight:900;margin:60px 0;box-shadow:0 20px 50px rgba(245,158,11,0.4);}

.mode-toggle{position:fixed;top:30px;right:30px;z-index:9999;background:var(--card);padding:18px;border-radius:50px;cursor:pointer;font-size:2rem;box-shadow:0 15px 40px rgba(0,0,0,0.6);}
.hidden{display:none !important;}
</style>
</head>
<body>

<div class="mode-toggle" onclick="toggleMode()">Toggle Mode</div>

<div class="container">
  <header>
    <h1>IPL 2026 MEGA AUCTION</h1>
    <p class="subtitle">Live Bidding • Team Panel • Full Control</p>
  </header>

  <div class="top-bar">
    <div class="status stopped" id="statusText">NOT STARTED</div>
    <div class="timer">Time: <span id="timer">01:00</span></div>
  </div>

  <div class="not-started" id="notStartedBanner">
    AUCTION NOT STARTED<br>
    <small style="font-size:2rem;">Waiting for Admin to Start...</small>
  </div>

  <div class="set-nav">
    <button class="set-btn" onclick="prevSet()">Previous Set</button>
    <div class="set-info" id="setInfo">SET 1 — BATTERS</div>
    <button class="set-btn" onclick="nextSet()">Next Set</button>
  </div>

  <div id="mainView">
    <div class="grid">
      <div>
        <div class="card player-card">
          <h2 style="color:var(--gold);font-size:3.5rem;">CURRENT PLAYER</h2>
          <div class="player-photo" id="playerPhoto">DC</div>
          <h2 id="playerName" style="font-size:6rem;margin:50px 0;">Loading...</h2>
          <p id="playerInfo" style="font-size:2.5rem;margin:40px 0;">Please wait...</p>

          <div class="current-bid" id="currentBid">₹ 2.00 Cr</div>

          <div class="bid-team">
            <div class="team-logo" id="bidTeamLogo">--</div>
            <div>
              <div style="opacity:0.8;font-size:2rem;">Highest Bidder</div>
              <div id="bidTeamName" style="font-size:5rem;font-weight:900;">No bids yet</div>
            </div>
          </div>

          <div class="interested" id="interestedTeams"></div>

          <div id="soldUnsoldButtons" style="margin-top:60px;display:flex;gap:40px;justify-content:center;">
            <button class="btn btn-green" onclick="soldToCurrent()">SOLD</button>
            <button class="btn btn-red" onclick="unsoldCurrent()">UNSOLD</button>
          </div>
        </div>
      </div>

      <div>
        <div class="card">
          <h3 style="color:var(--gold);font-size:3rem;margin-bottom:30px;">TEAM PURSE & SLOTS</h3>
          <table class="team-table" id="teamTable">
            <thead><tr><th>Team</th><th>Purse</th><th>Slots</th><th>OS</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="card">
          <h3 style="color:var(--gold);font-size:3rem;margin-bottom:25px;">LIVE BID LOG</h3>
          <div style="max-height:600px;overflow-y:auto;">
            <ul style="list-style:none;padding:0;" id="activityList">
              <li>Waiting for auction to start...</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- BETA FEATURES -->
  <div class="beta-banner">
    Upcoming Features (Beta Testing)
    <br><small style="font-size:1.8rem;">• Sold Players List • Team Squad View • Live Chat • RTGS Mode • Auto-Bidding • Mobile App Sync</small>
  </div>

  <!-- LOGIN -->
  <div class="login-box">
    <h2 style="font-size:4.5rem;color:var(--gold);">LOGIN</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button class="btn btn-blue" onclick="doLogin()">ENTER AUCTION</button>
  </div>

  <!-- TEAM BIDDING PANEL -->
  <div class="team-bid-panel" id="teamBidPanel">
    <h2 id="teamNameDisplay" style="font-size:4rem;color:var(--gold);">Your Team</h2>
    <div class="current-bid" style="font-size:5rem;margin:40px 0;" id="teamCurrentBid">₹ 2.00 Cr</div>
    <div class="bid-buttons">
      <button class="bid-btn btn-green" onclick="teamBid(0.25)">+0.25</button>
      <button class="bid-btn btn-green" onclick="teamBid(0.50)">+0.50</button>
      <button class="bid-btn btn-green" onclick="teamBid(1)">+1 Cr</button>
      <button class="bid-btn btn-orange" onclick="teamBid(2)">+2 Cr</button>
      <button class="bid-btn btn-orange" onclick="teamBid(5)">+5 Cr</button>
      <button class="bid-btn btn-purple" onclick="teamBid(10)">+10 Cr</button>
    </div>
    <p style="margin-top:40px;font-size:2rem;">
      Purse Left: <span id="teamPurse">₹0 Cr</span> | Slots: <span id="teamSlots">0</span>
    </p>
  </div>

  <!-- ADMIN PANEL -->
  <div class="card admin-panel" id="adminPanel">
    <h2 style="color:var(--red);text-align:center;font-size:4rem;margin-bottom:50px;">ADMIN CONTROL</h2>
    <div style="display:flex;gap:40px;justify-content:center;margin-bottom:60px;flex-wrap:wrap;">
      <button class="btn btn-green" onclick="startAuction()">START AUCTION</button>
      <button class="btn btn-red" onclick="stopAuction()">STOP AUCTION</button>
    </div>
    <div class="admin-grid">
      <button class="btn btn-green" onclick="soldToCurrent()">SOLD</button>
      <button class="btn btn-red" onclick="unsoldCurrent()">UNSOLD</button>
      <button class="btn btn-purple" onclick="nextPlayer()">NEXT PLAYER</button>
      <button class="btn btn-orange" onclick="randomPlayer()">RANDOM PLAYER</button>
    </div>
  </div>
</div>

<!-- SOUNDS -->
<audio id="bidSound" src="https://assets.mixkit.co/sfx/preview/mixkit-coin-win-notification-2634.mp3"></audio>
<audio id="soldSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-gong-1939.mp3"></audio>
<audio id="timerBeep" src="https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3"></audio>

<script>
// Global state
let data = { sets: [], teams: [] };
let currentSet = 0, currentPlayer = 0;
let auctionOn = false, isAdmin = false, loggedInTeam = null;
let currentBid = 0, highestBidder = null;
let timerInterval;

// Load data
fetch('data.json')
  .then(r => r.json())
  .then(d => {
    data = d;
    renderTeams();
    updateSetInfo();
    showPlayer(0, 0);
  })
  .catch(() => alert("data.json missing!"));

// Render Teams
function renderTeams() {
  const tbody = document.querySelector("#teamTable tbody");
  tbody.innerHTML = "";
  data.teams.forEach(t => {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${t.team_name}</td><td>₹${t.purse_crores} Cr</td><td>${t.overall_slots_left}</td><td>${t.overseas_slots_left}</td>`;
    tbody.appendChild(tr);
  });
}

// Update Set Info
function updateSetInfo() {
  const info = document.getElementById("setInfo");
  if (info && data.sets[currentSet]) {
    info.textContent = `SET ${data.sets[currentSet].set_number} — ${data.sets[currentSet].set_name.toUpperCase()}`;
  }
}

// Show Player
function showPlayer(setIdx, playerIdx) {
  if (!data.sets[setIdx]?.players[playerIdx]) return;
  const p = data.sets[setIdx].players[playerIdx];
  currentSet = setIdx;
  currentPlayer = playerIdx;

  document.getElementById("playerName").textContent = p.name;
  document.getElementById("playerInfo").textContent = `${p.role} • ${p.country} • Base: ₹${p.base_price_crore} Cr`;
  document.getElementById("playerPhoto").textContent = p.name.split(" ").map(n=>n[0]).join("").toUpperCase();
  currentBid = p.highestBid || p.base_price_crore;
  document.getElementById("currentBid").textContent = `₹ ${currentBid.toFixed(2)} Cr`;

  document.getElementById("bidTeamName").textContent = highestBidder ? highestBidder.team_name : "No bids yet";
  document.getElementById("bidTeamLogo").textContent = highestBidder ? highestBidder.team_name.split(" ").pop().slice(0,3).toUpperCase() : "--";

  document.getElementById("interestedTeams").innerHTML = "";
  document.getElementById("activityList").innerHTML = `<li>Base Price: ₹${p.base_price_crore} Cr</li>`;
  updateSetInfo();
}

// Team Bidding
function teamBid(amount) {
  if (!loggedInTeam) return alert("Login first!");
  if (!auctionOn) return alert("Auction not started!");
  if (currentBid + amount > loggedInTeam.purse_crores) return alert("Not enough purse!");

  currentBid += amount;
  loggedInTeam.purse_crores = (loggedInTeam.purse_crores - amount).toFixed(2);
  highestBidder = loggedInTeam;

  document.getElementById("bidSound").play();
  showPlayer(currentSet, currentPlayer);
  renderTeams();
  document.getElementById("teamPurse").textContent = `₹${loggedInTeam.purse_crores} Cr`;
}

// Random Player
function randomPlayer() {
  if (!isAdmin) return alert("Admin only!");
  const all = [];
  data.sets.forEach(s => all.push(...s.players));
  const rand = Math.floor(Math.random() * all.length);
  let count = 0;
  for (let s = 0; s < data.sets.length; s++) {
    if (count + data.sets[s].players.length > rand) {
      showPlayer(s, rand - count);
      break;
    }
    count += data.sets[s].players.length;
  }
  if (auctionOn) startTimer();
}

// Timer
function startTimer() {
  let time = 60;
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    time--;
    const m = String(Math.floor(time/60)).padStart(2,"0");
    const s = String(time%60).padStart(2,"0");
    document.getElementById("timer").textContent = `${m}:${s}`;
    if(time <= 10) document.getElementById("timerBeep").play();
    if(time <= 0) nextPlayer();
  }, 1000);
}

// Admin Controls
function startAuction() {
  if (!isAdmin) return alert("Admin only!");
  auctionOn = true;
  document.getElementById("notStartedBanner").style.display = "none";
  document.getElementById("statusText").textContent = "LIVE";
  document.getElementById("statusText").className = "status live";
  showPlayer(0, 0);
  startTimer();
}

function nextPlayer() {
  currentPlayer++;
  if (currentPlayer >= data.sets[currentSet].players.length) {
    currentSet++;
    currentPlayer = 0;
    if (currentSet >= data.sets.length) {
      alert("ALL SETS COMPLETED!");
      stopAuction();
      return;
    }
  }
  showPlayer(currentSet, currentPlayer);
  if (auctionOn) startTimer();
}

function soldToCurrent() {
  if (!isAdmin) return alert("Admin only!");
  document.getElementById("soldSound").play();
  confetti({particleCount:300, spread:120, origin:{y:0.6}});
  alert(`${data.sets[currentSet].players[currentPlayer].name} SOLD!`);
  nextPlayer();
}

function unsoldCurrent() {
  if (!isAdmin) return alert("Admin only!");
  document.getElementById("soldSound").play();
  alert("UNSOLD!");
  nextPlayer();
}

function doLogin() {
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value;

  if (u === "qwertyuiop" && p === "bluezone0025") {
    isAdmin = true;
    document.getElementById("adminPanel").style.display = "block";
    document.getElementById("soldUnsoldButtons").style.display = "flex";
    alert("ADMIN LOGIN SUCCESS!");
  } else {
    loggedInTeam = data.teams.find(t => t.username === u && t.password === p);
    if (loggedInTeam) {
      document.getElementById("teamBidPanel").style.display = "block";
      document.getElementById("teamNameDisplay").textContent = loggedInTeam.team_name;
      document.getElementById("teamPurse").textContent = `₹${loggedInTeam.purse_crores} Cr`;
      document.getElementById("teamSlots").textContent = loggedInTeam.overall_slots_left;
      alert(`Welcome ${loggedInTeam.team_name}!`);
    } else {
      alert("Invalid credentials");
    }
  }
}

function toggleMode() {
  document.body.classList.toggle("light-mode");
}

// Init
document.getElementById("soldUnsoldButtons").style.display = "none";
document.getElementById("teamBidPanel").style.display = "none";
</script>
</body>
</html>
